<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Overlay PCA or OPLS loadings with spectra — specload • MetaboMate</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Overlay PCA or OPLS loadings with spectra — specload" />

<meta property="og:description" content="Plotting overlayed NMR spectra. This function is based on ggplot2, a high-level plotting R package. For high ppm ranges computation time is relatively, so the range of input argument shift should be as small as possible. List argument an must have the first element define, even if it is only a single value. If colour and line width is specified, then at least one list elements of an must have the same length as X." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-78685833-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-78685833-2');
</script>

  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MetaboMate</a>
        <span class="label label-info" data-toggle="tooltip" data-placement="bottom" title="Package in development">0.0.0.9002</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/MetaboMate.html">Getting started</a>
</li>
<li>
  <a href="../reference/index.html">Documentation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Imps.html">Data Import and Pre-processing</a>
    </li>
    <li>
      <a href="../articles/MVA.html">Multivariate Statistical Analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/tkimhofer/MetaboMate">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://www.linkedin.com/in/torben-kimhofer-6337a725/">
    <span class="fa fa-linkedin fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/torben364">
    <span class="fa fa-twitter fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Overlay PCA or OPLS loadings with spectra</h1>
    <small class="dont-index">Source: <a href='https://github.com/tkimhofer/MetaboMate/blob/master/R/specload.R'><code>R/specload.R</code></a></small>
    <div class="hidden name"><code>specload.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Plotting overlayed NMR spectra. This function is based on ggplot2, a high-level plotting R package. For high ppm ranges computation time is relatively, so the range of input argument <code>shift</code> should be as small as possible. List argument <code>an</code> must have the first element define, even if it is only a single value. If colour and line width is specified, then at least one list elements of <code>an</code> must have the same length as <code>X</code>.</p>
    
    </div>

    <pre class="usage"><span class='fu'>specload</span>(<span class='no'>model</span>, <span class='no'>X</span>, <span class='no'>ppm</span>, <span class='kw'>shift</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>10</span>), <span class='no'>an</span>, <span class='kw'>alp</span> <span class='kw'>=</span> <span class='fl'>0.3</span>, <span class='kw'>size</span> <span class='kw'>=</span> <span class='fl'>0.5</span>,
  <span class='kw'>pc</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"Statistical reconstruction"</span>, <span class='st'>"Backscaled"</span>),
  <span class='kw'>title</span> <span class='kw'>=</span> <span class='st'>""</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>model</th>
      <td><p>PCA or OPLS model generated via <em>MetaboMate</em> package functions.</p></td>
    </tr>
    <tr>
      <th>X</th>
      <td><p>Input matrix with rows representing spectra</p></td>
    </tr>
    <tr>
      <th>ppm</th>
      <td><p>ppm variable</p></td>
    </tr>
    <tr>
      <th>shift</th>
      <td><p>ppm region to visualise.</p></td>
    </tr>
    <tr>
      <th>an</th>
      <td><p>List with one to three elements specifying facetting, colour and linetype (see Details).</p></td>
    </tr>
    <tr>
      <th>alp</th>
      <td><p>Alpha value for spectral lines.</p></td>
    </tr>
    <tr>
      <th>size</th>
      <td><p>plot line width.</p></td>
    </tr>
    <tr>
      <th>pc</th>
      <td><p>index of principal component to visualise, set to 1 if input model is OPLS</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>Type of loadings visualisation, either <code>'Statistical reconstruction'</code> or <code>'Backscaled'</code> (see Details).</p></td>
    </tr>
    <tr>
      <th>title</th>
      <td><p>Plot title.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional parameters passe on to ggplot's facet function.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>OPLS: If <code>type='Statistical reconstruction'</code> the function calculates the covariance (y axis) and Pearson's correlation (colouring) of the predictive OPLS scores with each X variable (x axis is ppm variable). If <code>type='Backscaled'</code> the OPLS loadings are backscaled with X feature standard deviations. Results are plotted over ppm, coloured according to OPLS model weights. Often, the latter method visualises model importance more robust due to the presence of false positive correlations. PCA: Function always calculates the statistical reconstruction.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='plotload.html'>plotload</a></code> <code><a href='specOverlay.html'>specOverlay</a></code> <code><a href='OPLS_MetaboMate-class.html'>OPLS_MetaboMate</a></code> <code><a href='opls.html'>opls</a></code> <code><a href='PCA_MetaboMate-class.html'>PCA_MetaboMate</a></code> <code><a href='pca.html'>pca</a></code></p></div>
    

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#see-also">See also</a></li>
          </ul>

    <h2>Author</h2>
    
Torben Kimhofer <a href='mailto:tkimhofer@gmail.com'>tkimhofer@gmail.com</a>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://tkimhofer.com'>Torben Kimhofer</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

